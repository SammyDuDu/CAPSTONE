<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>KPC</title>
        <link rel="icon" type="image/svg+xml" href="{{ url_for('static', path='images/favicon.svg') }}">
        <link rel="stylesheet" href="{{ url_for('static', path='styles/style.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', path='styles/feedback-improvements.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', path='styles/auth-improvements.css') }}">
    </head>
    <body>
        <div class="topbar">
            <div class="left-side">
                <a class="nav-chip" href="{{ url_for('root') }}">Home</a>
            </div>
            <div class="brand">KoSPA</div>
            <div class="right-side">
                <button class="login-btn" id="openLogin">log in</button>
            </div>
        </div>

        <div class="content">
            {% block content %}{% endblock %}
        </div>

        <!-- First-visit banner -->
        <div class="first-visit-banner" id="firstVisitBanner" hidden>
            <button class="banner-close" id="closeFirstVisit" aria-label="Close">✕</button>
            <div class="banner-text">
                Creating an account allows you to adjust learning to your personal voice. This increases accuracy significantly.
            </div>
        </div>

        <!-- User created banner -->
        <div class="first-visit-banner" id="userCreatedBanner" hidden>
            <div class="banner-text">user created</div>
        </div>

        <!-- Toast notification container -->
        <div class="toast-container" id="toastContainer"></div>

        <!-- Non-closable voice calibration modal -->
        <div class="overlay" id="calibrationOverlay" hidden></div>
        <div class="modal" id="calibrationModal" hidden>
            <div class="modal-title" style="text-align: center;">Record three basic sounds to calibrate the model</div>
            <div class="modal-body">
                <div id="calibrationPrompt" class="calibration-prompt">Say "aaa"</div>
                <button class="record-btn" id="calibrationRecordBtn" aria-pressed="false" title="Record 3 seconds">Record</button>
            </div>
        </div>

        <div class="overlay" id="overlay" hidden></div>
        <div class="modal" id="loginModal" hidden>
            <button class="modal-close" id="closeLogin">✕</button>
            <div class="modal-title" id="authModalTitle">Log in</div>
            <div class="modal-body">
                <div id="loginForm">
                    <div class="form-error" id="loginError" hidden></div>
                    <label>username</label>
                    <input type="text" id="loginUsername" class="input" placeholder="3+ characters" autocomplete="username" maxlength="30">
                    <div class="input-hint" id="usernameHint" hidden></div>
                    <label>password</label>
                    <input type="password" id="loginPassword" class="input" placeholder="4+ characters" autocomplete="current-password" maxlength="100">
                    <div class="input-hint" id="passwordHint" hidden></div>
                    <div class="modal-actions">
                        <button class="modal-btn" id="submitLogin">log in</button>
                        <button class="modal-btn secondary" id="submitSignup">sign up</button>
                    </div>
                </div>
                <div id="accountForm" hidden>
                    <div class="note" id="accountUser"></div>
                    <label>new password</label>
                    <input type="password" id="newPassword" class="input" placeholder="new password">
                    <div class="modal-actions">
                        <button class="modal-btn" id="changePassword">change password</button>
                        <button class="modal-btn secondary" id="logoutBtn">log out</button>
                    </div>
                </div>
            </div>
        </div>

        <script src="{{ url_for('static', path='scripts/auth-helpers.js') }}"></script>
        <script src="{{ url_for('static', path='scripts/ui.js') }}"></script>
    </body>
</html>